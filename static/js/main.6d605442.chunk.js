(this.webpackJsonpglaucomark=this.webpackJsonpglaucomark||[]).push([[0],{120:function(e,t,a){e.exports={Modal:"Modal_Modal__2Q_cQ"}},121:function(e,t,a){e.exports={Backdrop:"Backdrop_Backdrop__tO-Lj"}},125:function(e,t,a){e.exports=a(250)},130:function(e,t,a){},132:function(e,t,a){e.exports=a.p+"static/media/logo.ee7cd8ed.svg"},138:function(e,t){},139:function(e,t){},140:function(e,t){},144:function(e,t){},145:function(e,t){},146:function(e,t){},156:function(e,t){},166:function(e,t){},168:function(e,t,a){},250:function(e,t,a){"use strict";a.r(t);var n,r=a(0),o=a.n(r),l=a(25),c=a.n(l),i=(a(130),a(16)),s=a.n(i),u=a(26),m=a(122),d=a(118),g=a(119),p=a(124),h=a(123),f=(a(132),a(7)),w=a(18);window.tf=w,window.progress=0,window.bytesUsed=0,w.enableProdMode();var E=window.location.href+"model_full/model.json",y=function(){var e=Object(u.a)(s.a.mark((function e(t,a,r){var o,l,c,i,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Generation start"),console.log(a),o=w.browser.fromPixels(a),console.log("Original image size:",o.shape),l=w.tidy((function(){return w.image.resizeBilinear(o,[224,224]).expandDims(0).div(255)})),o.dispose(),n=performance.now(),e.next=9,t.predict(l);case 9:return c=e.sent,l.dispose(),i=performance.now(),console.log("Image Generated"),console.log("Took ".concat((i-n)/1e3," s to generate the image")),console.log("generated.print: "+c.flatten().arraySync()),u=100*(1-c.flatten().arraySync()),r.innerHTML="The chance for positive glaucoma is "+u+"%",c.dispose(),e.abrupt("return",!0);case 19:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(u.a)(s.a.mark((function e(t,a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return performance.now(),e.next=3,w.loadLayersModel(E).then(function(){var e=Object(u.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Model Loaded"),performance.now(),e.next=4,y(n,document.getElementById(t),document.getElementById(a));case 4:w.disposeVariables(),console.log(w.memory());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:window.progress=1;case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),b=a(120),x=a.n(b),k=function(e){return e.children},C=a(121),S=a.n(C),I=function(e){return e.show?o.a.createElement("div",{className:S.a.Backdrop,onClick:e.clicked}):null},B=function(e){return o.a.createElement(k,null,o.a.createElement(I,{show:e.show,clicked:e.modalClosed}),o.a.createElement("div",{className:x.a.Modal,style:{transform:e.show?"translateY(0)":"translateY(-100vh)",opacity:e.show?"1":"0"}},e.children))},U=a(66),_=a.n(U),N=function(e){return o.a.createElement("button",{className:[_.a.Button,_.a[e.btnType]].join(" "),onClick:e.clicked},e.children)},R=(a(167),a(168),new Image),T=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={uploadedImageURL:"data:image/png;",ImageURL:"data:image/png;",uploaded:!1,generationStatus:0,updateGenerationProgressInterval:-1,bytesUsed:0,operating:!1,width:1,height:1},e.operateCancelHandler=function(){e.setState({operating:!1})},e.operateHandler=function(){e.setState({operating:!0})},e.onUpload=function(t){var a=t.target,n=new FileReader;n.onload=function(){var t=n.result,a=new Image;a.src=t,a.onload=function(){e.setState({uploadedImageURL:t,uploaded:!0})}},n.readAsDataURL(a.files[0])},e.detectOD=function(t){var a,n=new FormData;n.append("image",t.files[0]),(a=console).log.apply(a,Object(m.a)(n)),fetch("https://cors-anywhere.herokuapp.com/http://47.251.47.22:5000/image",{method:"POST",body:n}).then((function(e){return e.text()})).then((function(t){R.src="data:image/png;base64,"+t,e.setState({ImageURL:"data:image/png;base64,"+t}),R.onload=function(){e.setState({width:R.width,height:R.width})},v("output","result")&&setTimeout((function(){e.setState({generationStatus:2})}),2e3)})).catch((function(e){return console.log("error",e)}))},e.generate=Object(u.a)(s.a.mark((function t(){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.state.generationStatus){t.next=2;break}return t.abrupt("return");case 2:if(console.log(e.state),!1!==e.state.uploaded){t.next=6;break}return alert("Please upload an image."),t.abrupt("return");case 6:return window.progress=0,window.bytesUsed=0,a=setInterval((function(){e.setState({generationProgress:100*window.progress,bytesUsed:window.bytesUsed}),1!==e.state.generationStatus&&clearInterval(a)}),500),e.setState({generationStatus:1,updateGenerationProgressInterval:a}),t.prev=10,t.next=13,e.detectOD(document.getElementById("image"));case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(10),alert("Error encountered while generating image: "+t.t0),e.setState({generationStatus:0});case 19:case"end":return t.stop()}}),t,null,[[10,15]])}))),e.componentWillUnmount=function(){-1!==e.state.updateGenerationProgressInterval&&clearInterval(e.state.updateGenerationProgressInterval)},e}return Object(g.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"app"},o.a.createElement(f.Container,{fluid:!0,style:{display:0===this.state.generationStatus?"block":"none"}},o.a.createElement(f.Row,{className:"margin"},o.a.createElement("div",{className:"topbar"},o.a.createElement("h1",{className:"title"},"GlaucoMark: Take a Glaucoma Test at Home"),o.a.createElement("a",{href:"https://github.com/Lempickax/Glaucomark"},"View Source Code"))),o.a.createElement(f.Row,{className:"margin"},o.a.createElement(f.Col,null),o.a.createElement(f.Col,{xs:"12",md:"8",lg:"6"}),o.a.createElement(f.Col,null)),o.a.createElement(f.Row,{className:"margin"},o.a.createElement(f.Col,null),o.a.createElement(f.Col,{xs:"12",md:"8",lg:"5",xl:"4",style:{textAlign:"center",marginTop:"80px"}},o.a.createElement("h5",{style:{textAlign:"center",width:"100%"}},"Upload a image of retina to continue"),o.a.createElement("input",{label:this.state.uploaded?"Change the image":"Upload an image",onChange:this.onUpload,multiple:!1,custom:!0,type:"file",name:"image",id:"image",alt:"",width:this.state.width,height:this.state.height}),o.a.createElement("img",{id:"uploaded-image",alt:"",src:this.state.uploadedImageURL})),o.a.createElement(f.Col,null)),o.a.createElement(f.Row,{className:"margin"},o.a.createElement(f.Col,null),o.a.createElement(f.Col,{xs:"12",md:"8",lg:"6",style:{textAlign:"center"}},o.a.createElement(B,{show:this.state.operating,modalClosed:this.operateCancelHandler},o.a.createElement("div",null,o.a.createElement("h1",null,"Term of Use "),o.a.createElement("p",{style:{textAlign:"left"}},"The result from this website can only be used as references."),o.a.createElement("p",{style:{textAlign:"left"}},"While the predicting model had been validated with a high accuracy, the training dataset still lacks variety."," "),o.a.createElement("p",{style:{textAlign:"left"}},"Thus, the author of this site makes no claims, promises or guarantees about the testing results, and expressly disclaims liability for any potential errors."),o.a.createElement("p",{style:{fontWeight:"bold"}},"Please see a doctor for final diagnosis."," ")),o.a.createElement("div",null,o.a.createElement(N,{btnType:"Success",clicked:this.generate},"Agree"),o.a.createElement(N,{btnType:"Danger",clicked:this.operateCancelHandler},"Cancel"))),o.a.createElement(f.Button,{variant:"primary",onClick:this.operateHandler},"Predict")),o.a.createElement(f.Col,null))),o.a.createElement("div",{className:"overlay",style:{display:1===this.state.generationStatus?"block":"none"}},o.a.createElement("div",{style:{marginTop:"calc( 50vh - 50px )",height:"100px",textAlign:"center"}},o.a.createElement(f.Container,{fluid:!0},o.a.createElement(f.Row,null,o.a.createElement(f.Col,null),o.a.createElement(f.Col,{xs:"12",md:"8",lg:"6",style:{textAlign:"center"}},o.a.createElement(f.Spinner,{animation:"border",role:"status"},o.a.createElement("span",{className:"sr-only"},"Loading...")),o.a.createElement("p",null,"Predicting results..."),o.a.createElement("p",null,"This may take 15 to 30 seconds depending on your device.")),o.a.createElement(f.Col,null))))),o.a.createElement("div",{className:"overlay",style:{display:2===this.state.generationStatus?"block":"none"}},o.a.createElement(f.Container,{fluid:!0},o.a.createElement(f.Row,{className:"margin"},o.a.createElement(f.Col,null),o.a.createElement(f.Col,{textAlign:"center",xs:"12",md:"8",lg:"5",xl:"4",style:{textAlign:"center",margin:"20px"}},o.a.createElement("img",{id:"output",src:this.state.ImageURL}),o.a.createElement("div",{id:"result"})),o.a.createElement(f.Col,null)),o.a.createElement(f.Row,{className:"margin"},o.a.createElement(f.Col,null),o.a.createElement(f.Col,{xs:"12",md:"12",lg:"12",xl:"10",style:{textAlign:"center",margin:"20px"}},o.a.createElement(f.Button,{variant:"primary",onClick:function(){return window.location.reload()}},"Restart")),o.a.createElement(f.Col,null)))))}}]),a}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},66:function(e,t,a){e.exports={Button:"Button_Button__34Npy",Success:"Button_Success__3b4Ig",Danger:"Button_Danger__1WXlI"}}},[[125,1,2]]]);
//# sourceMappingURL=main.6d605442.chunk.js.map